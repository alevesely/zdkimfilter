Database changes:

The table msg_ref has an additional flag "dnswl" in colum auth.  In MySQL, if
the table was created as exemplified in the zfilter_db man page, the flag can
be added like so:

   ALTER TABLE msg_ref MODIFY COLUMN auth SET \
    ('author', 'spf_helo', 'spf', 'dkim', 'vbr', 'rep', 'rep_s', 'dnswl') \
     NOT NULL;


Config file change:

New options: trust_a_r and trusted_dnswl.  They have to be set according to the
ALLOW_EXCLUSIVE and BLACKLISTS settings in Courier esmtpd.  With that setup, it
is possible to whitelist SPF and ADSP.  To use dnswl.org, I suggest setting as
follows:

Courier esmtpd: (don't override BLOCK, ask for TXT record too --trailing comma)
BLACKLISTS="-allow=list.dnswl.org,DNSWL, -block=...
ALLOW_EXCLUSIVE=1

Courier bofh: (add allowok where relevant)
opt BOFHSPFMAILFROM=allowok,pass,none,neutral,softfail,unknown,error

zdkimfilter.conf: (trusted_dnswl has a default, just add trust_a_r)
trust_a_r

See the zdkimfilter.conf and couriertcpd man pages for details.


Another new option: add_auth_pass

Internal mail is signed but not verified, but with this new option one can
still have an Authentication-Results, for example to color unauthenticated
messages:

   if (!/^Authentication-Results:.*=pass\b/:h)
   {
      KEYWORDS='nopass';
   }

